# ğŸŒ ESP8266_MQTT_EEPROM_WebServer_PWM_Relays
Ù†Ø¸Ø§Ù… ESP8266 Ù„Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© Ø¹Ø¨Ø± MQTTØŒ Ù…Ø¹ Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙÙŠ EEPROMØŒ ØµÙØ­Ø© ÙˆÙŠØ¨ Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§ÙŠ ÙØ§ÙŠØŒ ÙˆØ§Ù„ØªØ­ÙƒÙ… ÙÙŠ PWM Ùˆ 12 Ø±ÙŠÙ„ÙŠÙ‡

**Author:** Abdelrahman Elnahrawy  
**License:** MIT

![ESP8266](https://img.shields.io/badge/Platform-ESP8266-blue)
![Language](https://img.shields.io/badge/Language-C%2FC%2B%2B-green)
![Status](https://img.shields.io/badge/Status-Prototype-orange)

---

## ğŸ“Œ Overview | Ù†Ø¸Ø±Ø© Ø¹Ø§Ù…Ø©

**English**  
This project uses an ESP8266 to:  
- Connect to WiFi using saved credentials from EEPROM  
- Fall back to SoftAP mode and web page for WiFi configuration if needed  
- Communicate with MQTT broker to receive commands and publish statuses  
- Control 6 relays and 6 PWM channels  
- Persist relay states, PWM values, and configuration in EEPROM  
- Handle automatic restart on connection failure  

**Ø§Ù„Ø¹Ø±Ø¨ÙŠ**  
Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ ÙŠØ³ØªØ®Ø¯Ù… ESP8266 Ù„Ù„Ù‚ÙŠØ§Ù… Ø¨Ø§Ù„ØªØ§Ù„ÙŠ:  
- Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„ÙˆØ§ÙŠ ÙØ§ÙŠ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø®Ø²Ù†Ø© ÙÙŠ EEPROM  
- ØªØ´ØºÙŠÙ„ Ù†Ù‚Ø·Ø© ÙˆØµÙˆÙ„ SoftAP ÙˆØµÙØ­Ø© ÙˆÙŠØ¨ Ù„Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ÙˆØ§ÙŠ ÙØ§ÙŠ Ø¥Ø°Ø§ ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„  
- Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø¨Ø±ÙˆÙƒØ± MQTT Ù„ØªÙ„Ù‚ÙŠ Ø§Ù„Ø£ÙˆØ§Ù…Ø± ÙˆÙ†Ø´Ø± Ø§Ù„Ø­Ø§Ù„Ø§Øª  
- Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ 6 Ø±ÙŠÙ„ÙŠÙ‡ Ùˆ 6 Ù…Ø®Ø±Ø¬Ø§Øª PWM  
- Ø­ÙØ¸ Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø±ÙŠÙ„ÙŠÙ‡ØŒ Ù‚ÙŠÙ… PWMØŒ ÙˆØ§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙÙŠ EEPROM  
- Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ´ØºÙŠÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù†Ø¯ ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„  

---

## âš™ï¸ Features | Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª

- EEPROM-based persistence for WiFi credentials, relay states, and PWM values  
- WebServer POST form for WiFi configuration  
- MQTT publish/subscribe for relays and PWM control  
- Automatic reconnect to WiFi and MQTT  
- Non-blocking code using `millis()` for timing  
- Flexible relay and PWM control via MQTT messages  

---

## ğŸ§© Hardware Requirements | Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø¹ØªØ§Ø¯ÙŠØ©

| Component | Ø§Ù„Ù…ÙƒÙˆÙ‘Ù† |
|---------|---------|
| ESP8266 Board | NodeMCU / Wemos D1 mini |
| Relays | 12 Ø±ÙŠÙ„ÙŠÙ‡ Ù„Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© |
| PWM-controlled Devices | 6 Ù…Ø®Ø±Ø¬Ø§Øª PWM |
| Push Button / Sensors | Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ø¬Ø© |
| Resistors & Wires | Ù…Ù‚Ø§ÙˆÙ…Ø§Øª ÙˆØ£Ø³Ù„Ø§Ùƒ ØªÙˆØµÙŠÙ„ |
| MQTT Broker | Ø¨Ø±ÙˆÙƒØ± MQTT (Ù…Ø«Ø§Ù„: 192.168.1.123) |

---

## ğŸ”Œ Pin Connections | ØªÙˆØµÙŠÙ„ Ø§Ù„Ø­Ø³Ø§Ø³Ø§Øª Ùˆ Ø§Ù„Ø±ÙŠÙ„ÙŠÙ‡

> ÙŠØ¬Ø¨ ØªØ¹Ø¯ÙŠÙ„ Ø­Ø³Ø¨ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ØŒ Ø£Ù…Ø«Ù„Ø©:  

| Device | ESP8266 Pin |
|--------|-------------|
| Relay 1 | GPIO 12 |
| Relay 2 | GPIO 13 |
| Relay 3 | GPIO 14 |
| Relay 4 | GPIO 15 |
| Relay 5 | GPIO 0 |
| Relay 6 | GPIO 16 |
| PWM 0 | GPIO 5 |
| PWM 1 | GPIO 4 |
| PWM 2 | GPIO 0 |
| PWM 3 | GPIO 2 |
| PWM 4 | GPIO 14 |
| PWM 5 | GPIO 12 |

---

## ğŸ§  Software Logic | Ù…Ù†Ø·Ù‚ Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬

1. Read WiFi credentials from EEPROM  
2. Connect to WiFi or fallback to SoftAP mode  
3. Launch WebServer for configuration in SoftAP mode  
4. Connect to MQTT broker and subscribe to relay/PWM topics  
5. Parse incoming MQTT payload to update:  
   - Relays R0-R5 ON/OFF  
   - PWM0-PWM5 values (0-255)  
   - Timers and modes  
6. Store updated states in EEPROM  
7. Auto-reconnect on WiFi or MQTT failure, with system restart if needed  

---

## ğŸ·ï¸ Tags

ESP8266  
MQTT  
EEPROM  
WebServer  
PWM  
Home-Automation  
IoT  
Relay-Control  
NodeMCU  
Wemos  
Wireless-IoT  

---

## ğŸ“„ License
MIT License - provided by Abdelrahman Elnahrawy for educational and research purposes.
